<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="layout/layout(title='글쓰기')">
<!-- Body-->
<!-- Header -->

<head>
	<style>
		body {
			max-width: 1400px;
			padding: 0 20px;
			margin: 20px auto;
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			overflow-y: scroll;
		}

		/* Set the minimum height of Classic editor */
		.ck.ck-editor__editable_inline:not(.ck-editor__nested-editable) {
			min-height: 400px;
		}

		/* Styles to render an editor with a sidebar for comments & suggestions */
		.container {
			display: flex;
			flex-direction: row;
		}

		.document-outline-container {
			background-color: #f3f7fb;
			width: 200px;
		}

		.sidebar {
			width: 320px;
		}

		#editor-container .ck.ck-editor {
			width: 860px;
		}

		#editor-container .sidebar {
			margin-left: 20px;
		}

		#editor-container .sidebar.narrow {
			width: 30px;
		}

		/* Keep the automatic height of the editor for adding comments */
		.ck-annotation-wrapper .ck.ck-editor__editable_inline {
			min-height: auto;
		}

		/* Styles for viewing revision history */
		#revision-viewer-container {
			display: none;
		}

		#revision-viewer-container .ck.ck-editor {
			width: 860px;
		}

		#revision-viewer-container .ck.ck-content {
			min-height: 400px;
		}

		#revision-viewer-container .sidebar {
			border: 1px #c4c4c4 solid;
			margin-left: -1px;
			width: 320px;
		}

		#revision-viewer-container .ck.ck-revision-history-sidebar__header {
			height: 39px;
			background: #FAFAFA;
		}

		.hidden {
			display: none !important;
		}
	</style>
</head>

<body>
	<!-- Page Content-->
	<th:block layout:fragment="content">
		<!-- Main Slider-->
		<section class="hero-slider" style="background-image: url(img/hero-slider/main-bg.jpg);">
			<div class="container padding-bottom-2x">
				<div class="row">
					<div class="col-lg-9 col-md-8 order-md-2">
						<h6 class="text-muted text-normal text-uppercase margin-top-2x">게시판 글쓰기</h6>
						<hr class="margin-bottom-1x">
						<form action="show.html" th:action th:object="${board}" method="POST" onsubmit="validateForm(event)">
							<div class="form-group row">
								<label class="col-2 col-form-label" for="select-input">필수선택</label>
								<div class="col-10">
									<select class="form-control" id="select-input" th:field="*{boardGroupId}">
										<option value="">게시판을 선택하세요..</option>
										<option value="1">자유게시판</option>
										<option value="2">1:1문의</option>
										<option th:if="${board.isAdmin} eq 2" value="3">공지사항</option>
										<option th:if="${board.isAdmin} eq 2" value="4">자주묻는질문</option>
									</select>
								</div>
							</div>
							<div class="form-group row">
								<label class="col-2 col-form-label" for="text-input">제목</label>
								<div class="col-10">
									<input class="form-control" type="text" id="text-input" th:field="*{title}"
										placeholder="제목을 입력하세요.">
								</div>
							</div>
							
							<div id="presence-list-container"></div>

							<div id="editor-container">
								<div class="container">
									<div id="outline" class="document-outline-container"></div>
									<div id="editor" ></div>
									<div class="sidebar" id="sidebar"></div>
								</div>
							</div>

							<div id="revision-viewer-container">
								<div class="container">
									<div id="revision-viewer-editor"></div>
									<div class="sidebar" id="revision-viewer-sidebar"></div>
								</div>
							</div>
							<input type="hidden" id="editorContent" name="editorContent" th:field="*{content}" />
							
							<hr class="my-4">


							<div class="row">
								<div class="col">
									<input type="hidden" id="userName" name="userName" th:value="${session.sUserId}">

									<button class="w-100 btn btn-primary btn-lg" type="submit">등록</button>
								</div>
								<div class="col">
									<button class="w-100 btn btn-secondary btn-lg"
										onclick="history.back()">돌아가기</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
<script>
// content 변수를 함수 외부에서 선언
let content;

function validateForm(event) {
    let boardGroupId = document.querySelector("#select-input").value;
    let title = document.querySelector("#text-input").value;
    let memberId = document.querySelector("#userName").value;
    
    // content 값을 설정하고 디버깅 메시지를 출력
    content = editor.getData();
    console.log('Content:', content);

    if (boardGroupId === null || boardGroupId === "") {
        window.alert("게시판을 선택하세요.");
        event.preventDefault();
        return false;
    }

    if (title === null || title === "") {
        window.alert("제목을 입력하세요.");
        event.preventDefault();
        return false;
    }

    if (content === null || content === "") {
        window.alert("내용을 입력하세요.");
        event.preventDefault();
        return false;
    }

    if (memberId === null || memberId === "") {
        window.alert("로그인을 하세요!");
        event.preventDefault();
        return false;
    }

    let editorContentInput = document.querySelector("#editorContent");
    editorContentInput.value = content;
    return true;
}

</script>

			<script>
				// This sample still does not showcase all CKEditor 5 features (!)
				// Visit https://ckeditor.com/docs/ckeditor5/latest/features/index.html to browse all the features.
				CKEDITOR.ClassicEditor.create(document.querySelector('#editor'), {
					// https://ckeditor.com/docs/ckeditor5/latest/features/toolbar/toolbar.html#extended-toolbar-configuration-format
					toolbar: {
						items: [
							'aiCommands', 'aiAssistant', '|',
							'ckbox', 'uploadImage', '|',
							'exportPDF', 'exportWord', '|',
							'comment', 'trackChanges', 'revisionHistory', '|',
							'findAndReplace', 'selectAll', 'formatPainter', '|',
							'undo', 'redo',
							'-',
							'bold', 'italic', 'strikethrough', 'underline', 'removeFormat', '|',
							'bulletedList', 'numberedList', 'todoList', '|',
							'outdent', 'indent', '|',
							'alignment', '|',
							'-',
							'heading', '|',
							'fontSize', 'fontFamily', 'fontColor', 'fontBackgroundColor', 'highlight', '|',
							'link', 'blockQuote', 'insertTable', 'mediaEmbed', 'codeBlock', 'htmlEmbed', 'tableOfContents', 'insertTemplate', '|',
							'specialCharacters', 'horizontalLine', 'pageBreak', '|',
							// Intentionally skipped buttons to keep the toolbar smaller, feel free to enable them:
							// 'code', 'subscript', 'superscript', 'textPartLanguage', '|',
							// ** To use source editing remember to disable real-time collaboration plugins **
							// 'sourceEditing'
						],
						shouldNotGroupWhenFull: true
					},
					// Changing the language of the interface requires loading the language file using the <script> tag.
					// language: 'es',
					list: {
						properties: {
							styles: true,
							startIndex: true,
							reversed: true
						}
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/headings.html#configuration
					heading: {
						options: [
							{model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph'},
							{model: 'heading1', view: 'h1', title: 'Heading 1', class: 'ck-heading_heading1'},
							{model: 'heading2', view: 'h2', title: 'Heading 2', class: 'ck-heading_heading2'},
							{model: 'heading3', view: 'h3', title: 'Heading 3', class: 'ck-heading_heading3'},
							{model: 'heading4', view: 'h4', title: 'Heading 4', class: 'ck-heading_heading4'},
							{model: 'heading5', view: 'h5', title: 'Heading 5', class: 'ck-heading_heading5'},
							{model: 'heading6', view: 'h6', title: 'Heading 6', class: 'ck-heading_heading6'}
						]
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/font.html#configuring-the-font-family-feature
					fontFamily: {
						options: [
							'default',
							'Arial, Helvetica, sans-serif',
							'Courier New, Courier, monospace',
							'Georgia, serif',
							'Lucida Sans Unicode, Lucida Grande, sans-serif',
							'Tahoma, Geneva, sans-serif',
							'Times New Roman, Times, serif',
							'Trebuchet MS, Helvetica, sans-serif',
							'Verdana, Geneva, sans-serif'
						],
						supportAllValues: true
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/font.html#configuring-the-font-size-feature
					fontSize: {
						options: [10, 12, 14, 'default', 18, 20, 22],
						supportAllValues: true
					},
					// Be careful with the setting below. It instructs CKEditor to accept ALL HTML markup.
					// https://ckeditor.com/docs/ckeditor5/latest/features/general-html-support.html#enabling-all-html-features
					// htmlSupport: {
					// 	allow: [
					// 		{
					// 			name: /.*/,
					// 			attributes: true,
					// 			classes: true,
					// 			styles: true
					// 		}
					// 	]
					// },
					// Be careful with enabling previews
					// https://ckeditor.com/docs/ckeditor5/latest/features/html-embed.html#content-previews
					htmlEmbed: {
						showPreviews: true
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/mentions.html#configuration
					mention: {
						feeds: [
							{
								marker: '@',
								feed: [
									'@apple', '@bears', '@brownie', '@cake', '@cake', '@candy', '@canes', '@chocolate', '@cookie', '@cotton', '@cream',
									'@cupcake', '@danish', '@donut', '@dragée', '@fruitcake', '@gingerbread', '@gummi', '@ice', '@jelly-o',
									'@liquorice', '@macaroon', '@marzipan', '@oat', '@pie', '@plum', '@pudding', '@sesame', '@snaps', '@soufflé',
									'@sugar', '@sweet', '@topping', '@wafer'
								],
								minimumCharacters: 1
							}
						]
					},
					template: {
						definitions: [
							{
								title: 'The title of the template',
								description: 'A longer description of the template',
								data: '<p>Data inserted into the content</p>'
							},
							{
								title: 'Annual financial report',
								description: 'A report that spells out the company\'s financial condition.',
								data: `<figure class="table">
						<table style="border:2px solid hsl(0, 0%, 0%);">
							<thead>
								<tr>
									<th style="text-align:center;" rowspan="2">Metric name</th>
									<th style="text-align:center;" colspan="4">Year</th>
								</tr>
								<tr>
									<th style="background-color:hsl(90, 75%, 60%);text-align:center;">2019</th>
									<th style="background-color:hsl(90, 75%, 60%);text-align:center;">2020</th>
									<th style="background-color:hsl(90, 75%, 60%);text-align:center;">2021</th>
									<th style="background-color:hsl(90, 75%, 60%);text-align:center;">2022</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<th><strong>Revenue</strong></th>
									<td>$100,000.00</td>
									<td>$120,000.00</td>
									<td>$130,000.00</td>
									<td>$180,000.00</td>
								</tr>
								<tr>
									<th style="background-color:hsl(0, 0%, 90%);"><strong>Operating expenses</strong></th>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
								<tr>
									<th><strong>Interest</strong></th>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
								<tr>
									<th style="background-color:hsl(0, 0%, 90%);"><strong>Net profit</strong></th>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
									<td>&nbsp;</td>
								</tr>
							</tbody>
						</table>
					</figure>`
							},
						]
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/editor-placeholder.html#using-the-editor-configuration
					placeholder: '내용을 입력해 주세요!!',
					// Used by real-time collaboration
					cloudServices: {
						// Be careful - do not use the development token endpoint on production systems!
						tokenUrl: 'https://101433.cke-cs.com/token/dev/nLwflpFeMuU9jQRAKHUUl66QwmncpQfQMcvL?limit=10',
						webSocketUrl: 'wss://101433.cke-cs.com/ws',
						uploadUrl: 'https://101433.cke-cs.com/easyimage/upload/'
					},
					collaboration: {
						// Modify the channelId to simulate editing different documents
						// https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/real-time-collaboration/real-time-collaboration-integration.html#the-channelid-configuration-property
						channelId: 'document-id-6'
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/annotations/annotations-custom-configuration.html#sidebar-configuration
					sidebar: {
						container: document.querySelector('#sidebar')
					},
					documentOutline: {
						container: document.querySelector('#outline')
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/real-time-collaboration/users-in-real-time-collaboration.html#users-presence-list
					presenceList: {
						container: document.querySelector('#presence-list-container')
					},
					// Add configuration for the comments editor if the Comments plugin is added.
					// https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/annotations/annotations-custom-configuration.html#comment-editor-configuration
					comments: {
						editorConfig: {
							extraPlugins: CKEDITOR.ClassicEditor.builtinPlugins.filter(plugin => {
								// Use e.g. Ctrl+B in the comments editor to bold text.
								return ['Bold', 'Italic', 'Underline', 'List', 'Autoformat', 'Mention'].includes(plugin.pluginName);
							}),
							// Combine mentions + Webhooks to notify users about new comments
							// https://ckeditor.com/docs/cs/latest/guides/webhooks/events.html
							mention: {
								feeds: [
									{
										marker: '@',
										feed: [
											'@Baby Doe', '@Joe Doe', '@Jane Doe', '@Jane Roe', '@Richard Roe'
										],
										minimumCharacters: 1
									}
								]
							},
						}
					},
					// Do not include revision history configuration if you do not want to integrate it.
					// Remember to remove the 'revisionHistory' button from the toolbar in such a case.
					revisionHistory: {
						editorContainer: document.querySelector('#editor-container'),
						viewerContainer: document.querySelector('#revision-viewer-container'),
						viewerEditorElement: document.querySelector('#revision-viewer-editor'),
						viewerSidebarContainer: document.querySelector('#revision-viewer-sidebar'),
					},
					// https://ckeditor.com/docs/ckeditor5/latest/features/images/image-upload/ckbox.html
					ckbox: {
						// Be careful - do not use the development token endpoint on production systems!
						tokenUrl: 'https://101433.cke-cs.com/token/dev/nLwflpFeMuU9jQRAKHUUl66QwmncpQfQMcvL?limit=10'
					},
					// AI Assistant feature configuration.
					// https://ckeditor.com/docs/ckeditor5/latest/features/ai-assistant.html
					aiAssistant: {
						//     // Provide the URL to the OpenAI proxy endpoint in your application.
						//     apiUrl: 'http://url-to-your-openai-proxy-endpoint/'
					},
					// License key is required only by the Pagination plugin and non-realtime Comments/Track changes.
					licenseKey: 'YTZUQnpLMmZmbkxIeS9uOG15cVJFNXk4MzI5ck5DZlprYk0zenU5YkZUV2ZBT3pJaGFJQnJ3c2pGWEwzLU1qQXlNekV5TURFPQ==',
					removePlugins: [
						// Before enabling Pagination plugin, make sure to provide proper configuration and add relevant buttons to the toolbar
						// https://ckeditor.com/docs/ckeditor5/latest/features/pagination/pagination.html
						'Pagination',
						// Intentionally disabled, file uploads are handled by CKBox
						'Base64UploadAdapter',
						// Intentionally disabled, file uploads are handled by CKBox
						'CKFinder',
						// Intentionally disabled, file uploads are handled by CKBox
						'EasyImage',
						// Requires additional license key
						'WProofreader',
						// Incompatible with real-time collaboration
						'SourceEditing',
						// Careful, with the Mathtype plugin CKEditor will not load when loading this sample
						// from a local file system (file://) - load this site via HTTP server if you enable MathType
						'MathType'
						// If you would like to adjust enabled collaboration features:
						// 'RealTimeCollaborativeComments',
						// 'RealTimeCollaborativeTrackChanges',
						// 'RealTimeCollaborativeRevisionHistory',
						// 'PresenceList',
						// 'Comments',
						// 'TrackChanges',
						// 'TrackChangesData',
						// 'RevisionHistory',
					]
				})
					.then(editor => {
						window.editor = editor;

						// Example implementation to switch between different types of annotations according to the window size.
						// https://ckeditor.com/docs/ckeditor5/latest/features/collaboration/annotations/annotations-display-mode.html
						const annotationsUIs = editor.plugins.get('AnnotationsUIs');
						const sidebarElement = document.querySelector('.sidebar');
						let currentWidth;

						function refreshDisplayMode() {
							// Check the window width to avoid the UI switching when the mobile keyboard shows up.
							if (window.innerWidth === currentWidth) {
								return;
							}
							currentWidth = window.innerWidth;

							if (currentWidth < 1000) {
								sidebarElement.classList.remove('narrow');
								sidebarElement.classList.add('hidden');
								annotationsUIs.switchTo('inline');
							}
							else if (currentWidth < 1300) {
								sidebarElement.classList.remove('hidden');
								sidebarElement.classList.add('narrow');
								annotationsUIs.switchTo('narrowSidebar');
							}
							else {
								sidebarElement.classList.remove('hidden', 'narrow');
								annotationsUIs.switchTo('wideSidebar');
							}
						}

						editor.ui.view.listenTo(window, 'resize', refreshDisplayMode);
						refreshDisplayMode();

						return editor;
					})
					.catch(error => {
						console.error('There was a problem initializing the editor.', error);
					});
			</script>


		</section>

	</th:block>
	<th:block layout:fragment="recommendation"></th:block>
	<th:block layout:fragment="script">

	</th:block>
	
</body>

</html>